{"filter":false,"title":"password_resets_controller.rb","tooltip":"/app/controllers/password_resets_controller.rb","undoManager":{"mark":23,"position":23,"stack":[[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":3,"column":0},"end":{"row":3,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":3,"column":2},"end":{"row":4,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":4,"column":0},"end":{"row":4,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":4,"column":2},"end":{"row":5,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":5,"column":0},"end":{"row":5,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":4,"column":2},"end":{"row":4,"column":14}},"text":"  def create"},{"action":"insertText","range":{"start":{"row":4,"column":14},"end":{"row":5,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":5,"column":0},"end":{"row":15,"column":0}},"lines":["    @user = User.find_by(email: params[:password_reset][:email].downcase)","    if @user","      @user.create_reset_digest","      @user.send_password_reset_email","      flash[:info] = \"Email sent with password reset instructions\"","      redirect_to root_url","    else","      flash.now[:danger] = \"Email address not found\"","      render 'new'","    end"]},{"action":"insertText","range":{"start":{"row":15,"column":0},"end":{"row":15,"column":5}},"text":"  end"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":4,"column":2},"end":{"row":4,"column":4}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":0,"column":54},"end":{"row":1,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":1,"column":0},"end":{"row":1,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1,"column":2},"end":{"row":1,"column":51}},"text":"  before_action :get_user, only: [:edit, :update]"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":1,"column":2},"end":{"row":1,"column":4}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":1,"column":49},"end":{"row":2,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":2,"column":0},"end":{"row":2,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":20,"column":5},"end":{"row":21,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":21,"column":0},"end":{"row":21,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":21,"column":2},"end":{"row":22,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":22,"column":0},"end":{"row":22,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":2},"end":{"row":22,"column":11}},"text":"  private"},{"action":"insertText","range":{"start":{"row":22,"column":11},"end":{"row":23,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":23,"column":0},"end":{"row":29,"column":0}},"lines":["","    def get_user","      @user = User.find_by(email: params[:email])","      unless @user && @user.authenticated?(:reset, params[:id])","        redirect_to root_url","      end"]},{"action":"insertText","range":{"start":{"row":29,"column":0},"end":{"row":29,"column":7}},"text":"    end"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":22,"column":2},"end":{"row":22,"column":4}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":0},"end":{"row":23,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":2},"end":{"row":23,"column":4}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":4},"end":{"row":24,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":24,"column":0},"end":{"row":24,"column":4}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":23,"column":4},"end":{"row":24,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":24,"column":0},"end":{"row":24,"column":4}},"text":"    "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":24,"column":4},"end":{"row":24,"column":23}},"text":"    def user_params"},{"action":"insertText","range":{"start":{"row":24,"column":23},"end":{"row":25,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":25,"column":0},"end":{"row":26,"column":0}},"lines":["      params.require(:user).permit(:password, :password_confirmation)"]},{"action":"insertText","range":{"start":{"row":26,"column":0},"end":{"row":26,"column":7}},"text":"    end"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":24,"column":6},"end":{"row":24,"column":8}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":24,"column":4},"end":{"row":24,"column":6}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":20,"column":5},"end":{"row":21,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":21,"column":0},"end":{"row":21,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":21,"column":2},"end":{"row":22,"column":0}},"text":"\n"},{"action":"insertText","range":{"start":{"row":22,"column":0},"end":{"row":22,"column":2}},"text":"  "}]}],[{"group":"doc","deltas":[{"action":"insertText","range":{"start":{"row":22,"column":2},"end":{"row":22,"column":14}},"text":"  def update"},{"action":"insertText","range":{"start":{"row":22,"column":14},"end":{"row":23,"column":0}},"text":"\n"},{"action":"insertLines","range":{"start":{"row":23,"column":0},"end":{"row":39,"column":0}},"lines":["    if @user.password_reset_expired?","      flash[:danger] = \"Password reset has expired.\"","      redirect_to new_password_reset_path","    elsif @user.update_attributes(user_params)","      if (params[:user][:password].blank? &&","          params[:user][:password_confirmation].blank?)","        flash.now[:danger] = \"Password/confirmation can't be blank\"","        render 'edit'","      else","        flash[:success] = \"Password has been reset.\"","        log_in @user","        redirect_to @user","      end","    else","      render 'edit'","    end"]},{"action":"insertText","range":{"start":{"row":39,"column":0},"end":{"row":39,"column":5}},"text":"  end"}]}],[{"group":"doc","deltas":[{"action":"removeText","range":{"start":{"row":22,"column":2},"end":{"row":22,"column":4}},"text":"  "}]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":25,"column":41},"end":{"row":25,"column":41},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":40,"state":"start","mode":"ace/mode/ruby"}},"timestamp":1414445680214,"hash":"d155e0b88f8a5e16b1eaae2d0ebfc1769c0188d5"}